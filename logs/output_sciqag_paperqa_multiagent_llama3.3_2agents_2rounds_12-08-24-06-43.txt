Running experiment: sciqag_paperqa_multiagent_llama3.3_2agents_2rounds
saving results to: datasets/SciQAG/answer_results/paperqa_multiagent_llama3.3_2agents_2rounds 




 ANSWERING QUESTION: sciqag_question_1.json
 ----------------------------- 



--- ROUND 1/2 ---
[06:47:23] Starting paper search for 'Type 1 diabetes causes'.                                                                                                                                                                            
           paper_search for query 'Type 1 diabetes causes' and offset 0 returned 8 papers.                                                                                                                                                
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:47:25] gather_evidence starting for question 'What is Type 1 diabetes and what causes it?'.                                                                                                                                           
[06:48:36] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=2 | Current Cost=$0.0000                                                                                                                                          
[06:48:40] Generating answer for 'What is Type 1 diabetes and what causes it?'.                                                                                                                                                           
[06:49:09] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=2 | Current Cost=$0.0000                                                                                                                                          
           Answer: Type 1 diabetes is an autoimmune disease characterized by the selective destruction of insulin-producing beta cells in the pancreatic islets, leading to a lack of insulin production. The causes are believed to be   
           associated with genetics, environmental factors, nutritional effects, or a combination of these. This understanding is based on No2024 chunk 1, which provides a direct definition and explanation of Type 1 diabetes.         
                                                                                                                                                                                                                                          
           The context from other chunks (No2024 chunk 4, Braker chunk 3, No2024 chunk 2, No2024 chunk 3) supports the complexity of Type 1 diabetes by discussing enhanced endogenous glucose production due to gluconeogenesis, the use 
           of streptozotocin in experimental models to induce diabetes, and the analysis of metabolites associated with diabetes in diabetic rats. However, these chunks do not directly contribute to understanding the causes of Type 1 
           diabetes in humans but rather highlight aspects of the disease's manifestation and study.                                                                                                                                      
                                                                                                                                                                                                                                          
           Agent 2's summarization does not provide additional insights as it defaults to a generic answer and reasoning. Therefore, my analysis relies solely on the context provided by the No2024 chunks and Braker chunk 3.           
                                                                                                                                                                                                                                          
           Given the information, I conclude that Type 1 diabetes is primarily characterized by the autoimmune destruction of pancreatic beta cells, with its causes linked to genetic, environmental, nutritional factors, or a          
           combination thereof. The experimental models and studies mentioned in other chunks offer insight into the disease's effects and potential areas for research but do not elucidate the human causes beyond what No2024 chunk 1  
           states.                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: Type 1 diabetes is an autoimmune disease causing insulin deficiency due to beta cell destruction, with causes including genetics, environment, nutrition, or a combination.                                    
           REASONING SUMMARY: My reasoning process involved analyzing the direct definition from No2024 chunk 1 and considering complementary insights from other chunks and agent summarizations, concluding that the primary cause of   
           Type 1 diabetes is linked to autoimmune beta cell destruction influenced by various factors.                                                                                                                                   
Agent 1 answer time: 366.82784938812256
[06:49:13] Starting paper search for 'Type 1 diabetes causes'.                                                                                                                                                                            
           paper_search for query 'Type 1 diabetes causes' and offset 0 returned 8 papers.                                                                                                                                                
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:49:15] gather_evidence starting for question 'What is Type 1 diabetes and what causes it?'.                                                                                                                                           
[06:50:01] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=2 | Current Cost=$0.0000                                                                                                                                          
[06:50:04] Generating answer for 'What is Type 1 diabetes and what causes it?'.                                                                                                                                                           
[06:50:35] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=2 | Current Cost=$0.0000                                                                                                                                          
           Answer: Type 1 diabetes is an autoimmune disease characterized by the selective destruction of insulin-producing beta cells in the pancreatic islets, resulting in insulin deficiency. The causes of Type 1 diabetes are       
           multifactorial and include genetics, environmental factors, nutritional effects, or a combination of these. This understanding is based on the direct definition provided in No2024 chunk 1, which states that Type 1 diabetes 
           affects roughly 0.5% of the population in developed countries and is associated with various contributing factors.                                                                                                             
                                                                                                                                                                                                                                          
           The summarization from Agent 1 aligns with this interpretation, highlighting that Type 1 diabetes is an autoimmune disease causing insulin deficiency due to beta cell destruction, with causes including genetics,            
           environment, nutrition, or a combination. This agreement reinforces the conclusion that the primary cause of Type 1 diabetes is linked to autoimmune beta cell destruction influenced by various factors.                      
                                                                                                                                                                                                                                          
           Complementary insights from other chunks, such as No2024 chunk 4 and Braker chunk 3, further support this understanding by discussing the consequences of insulin deficiency, including enhanced endogenous glucose production 
           (EGP) and the breakdown of glycogen, which contribute to increased glucose levels. Additionally, the use of streptozotocin-treated animals in experimental models, as mentioned in Braker chunk 3, is a common method for      
           inducing diabetes, underscoring the autoimmune nature of Type 1 diabetes.                                                                                                                                                      
                                                                                                                                                                                                                                          
           In my reasoning process, I analyzed the direct definitions and descriptions provided in the context, particularly from No2024 chunk 1, and considered the complementary insights from other chunks and agent summarizations. By
           identifying points of agreement, such as the autoimmune cause of Type 1 diabetes, and incorporating additional details on the consequences of insulin deficiency and experimental models, I generated a coherent and accurate  
           understanding of Type 1 diabetes and its causes.                                                                                                                                                                               
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: Type 1 diabetes is an autoimmune disease causing insulin deficiency due to beta cell destruction, with multifactorial causes including genetics, environment, nutrition, or their combination.                 
           REASONING SUMMARY: My reasoning involved analyzing direct definitions from the context, identifying agreements among agent summarizations, and incorporating complementary insights to conclude that Type 1 diabetes is        
           primarily caused by autoimmune beta cell destruction influenced by various factors.                                                                                                                                            
Agent 2 answer time: 85.87587666511536
Round successful.

--- ROUND 2/2 ---
[06:50:38] Starting paper search for 'Type 1 diabetes causes'.                                                                                                                                                                            
[06:50:39] paper_search for query 'Type 1 diabetes causes' and offset 0 returned 8 papers.                                                                                                                                                
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:50:41] gather_evidence starting for question 'What is Type 1 diabetes and what causes it?'.                                                                                                                                           
[06:51:28] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=3 | Current Cost=$0.0000                                                                                                                                          
[06:51:31] Generating answer for 'What is Type 1 diabetes and what causes it?'.                                                                                                                                                           
[06:52:00] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=3 | Current Cost=$0.0000                                                                                                                                          
           Answer: Type 1 diabetes is an autoimmune disease characterized by the selective destruction of insulin-producing beta cells in the pancreatic islets, leading to insulin deficiency. The causes of Type 1 diabetes are         
           multifactorial and include genetics, environmental factors, nutritional effects, or a combination of these. This understanding is derived from analyzing direct definitions provided in the context, such as No2024 chunk 1,   
           which explicitly states that Type 1 diabetes results from the autoimmune destruction of beta cells and is influenced by various factors including genetics, environment, and nutrition.                                        
                                                                                                                                                                                                                                          
           The summarization from Agent 2 aligns with this conclusion, emphasizing that Type 1 diabetes is an autoimmune disease causing insulin deficiency due to beta cell destruction, with causes that are multifactorial, including  
           genetics, environment, nutrition, or their combination. This agreement among the context and other agents' summarizations strengthens the conclusion regarding the nature and causes of Type 1 diabetes.                       
                                                                                                                                                                                                                                          
           Incorporating complementary insights from No2024 chunks 4 and 5, as well as Braker chunk 3, provides additional depth into the metabolic implications and experimental models of Type 1 diabetes, such as the role of          
           gluconeogenesis and glycogenolysis in glucose level regulation, and the use of streptozotocin (STZ) to induce a model of Type 1 diabetes. However, these insights do not contradict but rather complement the understanding of 
           Type 1 diabetes as an autoimmune condition with multifactorial causes.                                                                                                                                                         
                                                                                                                                                                                                                                          
           Given the information provided in the context and the summarizations from other agents, there are no significant points of disagreement that would conflict with the conclusion regarding the definition and causes of Type 1  
           diabetes. The consensus among these sources supports a coherent and accurate understanding of the disease.                                                                                                                     
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: Type 1 diabetes is an autoimmune disease caused by the destruction of insulin-producing beta cells, influenced by genetics, environment, nutrition, or their combination.                                      
           REASONING SUMMARY: The answer is based on direct definitions from the context and agreement with other agents' summarizations, incorporating complementary insights without conflicts, to conclude the nature and causes of    
           Type 1 diabetes.                                                                                                                                                                                                               
Agent 1 answer time: 85.30593037605286
[06:52:04] Starting paper search for 'Type 1 diabetes causes'.                                                                                                                                                                            
           paper_search for query 'Type 1 diabetes causes' and offset 0 returned 8 papers.                                                                                                                                                
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:52:06] gather_evidence starting for question 'What is Type 1 diabetes and what causes it?'.                                                                                                                                           
[06:52:51] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=2 | Current Cost=$0.0000                                                                                                                                          
[06:52:55] Generating answer for 'What is Type 1 diabetes and what causes it?'.                                                                                                                                                           
[06:53:19] Status: Paper Count=8 | Relevant Papers=1 | Current Evidence=2 | Current Cost=$0.0000                                                                                                                                          
           Answer: Type 1 diabetes is an autoimmune disease characterized by the selective destruction of insulin-producing beta cells in the pancreatic islets. This destruction leads to insulin deficiency and changes in glucose      
           metabolism, including enhanced endogenous glucose production (EGP) due to gluconeogenesis fueled by amino acids from degraded protein or dietary ingestion. The causes of Type 1 diabetes are believed to be associated with a 
           combination of genetics, environmental factors, nutritional effects, or their interaction.                                                                                                                                     
                                                                                                                                                                                                                                          
           My reasoning process involves synthesizing information from the provided context and other agents' summarizations. Agent 1's summary directly states that Type 1 diabetes is an autoimmune disease caused by the destruction of
           insulin-producing beta cells, influenced by genetics, environment, nutrition, or their combination, which aligns with the information given in No2024 chunk 1. This agreement across different sources strengthens the         
           conclusion about the nature and causes of Type 1 diabetes. Furthermore, No2024 chunks 2, 3, and 4, along with Braker chunk 3, provide complementary insights into the metabolic changes associated with Type 1 diabetes, such  
           as increased glucose production from non-carbohydrate precursors and altered urinary metabolic profiles in diabetic models. These insights support the understanding of the disease's pathophysiology without contradicting the
           primary cause identified by Agent 1 and the context.                                                                                                                                                                           
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: Type 1 diabetes is an autoimmune disease caused by the destruction of insulin-producing beta cells, leading to insulin deficiency and altered glucose metabolism, with causes linked to genetics, environment, 
           nutrition, or their combination.                                                                                                                                                                                               
           REASONING SUMMARY: The answer is derived from synthesizing direct definitions and complementary insights from the context and other agents' summarizations, resolving into a coherent understanding of Type 1 diabetes' nature 
           and causes.                                                                                                                                                                                                                    
Agent 2 answer time: 79.06025576591492
Round successful.
All rounds successful.
Failed to extract final answer from multiagent consensus.


 ANSWERING QUESTION: sciqag_question_10.json
 ----------------------------- 



--- ROUND 1/2 ---
[06:53:32] Starting paper search for 'metabolite correlations in diabetic and control rats'.                                                                                                                                              
           paper_search for query 'metabolite correlations in diabetic and control rats' and offset 0 returned 8 papers.                                                                                                                  
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:53:35] gather_evidence starting for question 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                 
[06:54:23] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
[06:54:27] Generating answer for 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                                 
[06:54:54] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
           Answer: To address the question of how the correlations among the detected metabolites differed between the diabetic and control rats, we must delve into the specifics provided by the context. The study utilized a 1H       
           NMR-based metabolomics approach to investigate metabolic pathway disturbances in STZ-induced diabetes. By analyzing daily excreted quantities of detected metabolites and changes in their correlations, the researchers found 
           distinct differences between diabetic and control rats.                                                                                                                                                                        
                                                                                                                                                                                                                                          
           The context (No2024 chunks 1 through 6) consistently highlights that the correlations among metabolites differed significantly between the two groups. In diabetic rats, certain correlations increased, such as glucose with  
           urea, while others decreased, like glucose with lactate. Additionally, citrate's correlation with alanine, lactate, and succinate also decreased. This suggests a disruption in normal metabolic pathways, potentially         
           indicating impaired glucose homeostasis and altered energy metabolism.                                                                                                                                                         
                                                                                                                                                                                                                                          
           The summarizations from other agents are not directly applicable to this specific question as they do not provide additional insights beyond the context. Agent 2's default answer and reasoning do not contribute new         
           information to the analysis.                                                                                                                                                                                                   
                                                                                                                                                                                                                                          
           Given the evidence from the context, it is clear that diabetic rats exhibited altered correlations among detected metabolites compared to control rats. These alterations included both increased and decreased correlations   
           among various metabolite pairs, reflecting disturbances in metabolic pathways associated with diabetes.                                                                                                                        
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: The correlations among detected metabolites in diabetic rats differed from those in control rats, with changes including increased correlations (e.g., glucose with urea) and decreased correlations (e.g.,    
           glucose with lactate), indicating disrupted metabolic pathways.                                                                                                                                                                
           REASONING SUMMARY: The reasoning process involved analyzing the context provided by No2024 chunks 1 through 6, identifying key differences in metabolite correlations between diabetic and control rats, and concluding that   
           these differences reflect disturbances in metabolic pathways due to diabetes, without significant contributions from other agents' summarizations.                                                                             
Agent 1 answer time: 85.01901483535767
[06:54:57] Starting paper search for 'metabolite correlations in diabetic and control rats'.                                                                                                                                              
           paper_search for query 'metabolite correlations in diabetic and control rats' and offset 0 returned 8 papers.                                                                                                                  
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:55:00] gather_evidence starting for question 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                 
[06:55:47] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
[06:55:52] Generating answer for 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                                 
[06:56:19] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
           Answer: The correlations among detected metabolites in diabetic rats differed significantly from those in control rats. In diabetic rats, there was an increase in correlations between glucose and urea, as well as between   
           glucose and certain amino acids like alanine, suggesting enhanced endogenous glucose production fueled by amino acids. Conversely, the correlations between glucose and lactate, and between glucose and tricarboxylic acid    
           (TCA) cycle intermediates like citrate and succinate, were decreased. This disruption in metabolic pathways indicates a shift towards gluconeogenesis and away from glycolysis in diabetic rats.                               
                                                                                                                                                                                                                                          
           The context provided by No2024 chunks 3 through 6 consistently shows that the correlations among metabolites are altered in diabetic rats compared to control rats. For example, No2024 chunk 3 notes that the correlation of  
           glucose with urea increased dramatically in diabetic rats, while the correlation of glucose with lactate decreased. Similarly, Braker chunk 3 highlights distinct metabonomic profiles for diabetic rats, characterized by     
           elevated glucose signals.                                                                                                                                                                                                      
                                                                                                                                                                                                                                          
           My reasoning process involved analyzing these context chunks and identifying key differences in metabolite correlations between diabetic and control rats. Agent 1's summarization also concluded that the correlations among  
           detected metabolites differed between diabetic and control rats, with changes indicating disrupted metabolic pathways. I incorporated this complementary insight to support my conclusion that diabetes leads to significant   
           alterations in metabolic pathways.                                                                                                                                                                                             
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: The correlations among detected metabolites differ significantly between diabetic and control rats, with increased correlations between glucose and urea/amino acids, and decreased correlations between       
           glucose and lactate/TCA cycle intermediates.                                                                                                                                                                                   
           REASONING SUMMARY: My reasoning process analyzed context chunks (No2024 chunks 3-6, Braker chunk 3) and Agent 1's summarization to conclude that diabetes disrupts metabolic pathways, leading to altered correlations among   
           detected metabolites.                                                                                                                                                                                                          
Agent 2 answer time: 86.00111699104309
Round successful.

--- ROUND 2/2 ---
[06:56:26] Starting paper search for 'metabolite correlations in diabetic and control rats'.                                                                                                                                              
           paper_search for query 'metabolite correlations in diabetic and control rats' and offset 0 returned 8 papers.                                                                                                                  
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:56:30] gather_evidence starting for question 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                 
[06:57:33] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
[06:57:39] Generating answer for 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                                 
[06:58:03] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
           Answer: The correlations among the detected metabolites differed significantly between diabetic and control rats. In control rats, most metabolites correlated with one another with high correlation coefficients, indicating 
           a highly interconnected metabolic network. In contrast, diabetic rats showed an overall decrease in metabolic correlation, with several correlations decreased or changed. Specifically, the correlation between glucose and   
           urea increased significantly in diabetic rats, while the correlations between glucose and lactate, as well as glucose and TCA cycle intermediates, were disturbed. Additionally, the correlations among TCA intermediates were 
           altered, such as succinate no longer correlating with 2-oxoglutarate and citrate.                                                                                                                                              
                                                                                                                                                                                                                                          
           My reasoning process analyzed the context chunks (No2024 chunks 1, 3-6) and Agent 2's summarization to conclude that diabetes disrupts metabolic pathways, leading to altered correlations among detected metabolites. I       
           incorporated complementary insights from Agent 2's reasoning, which highlighted the increased correlations between glucose and urea/amino acids, and decreased correlations between glucose and lactate/TCA cycle              
           intermediates. The context chunks provided detailed information on the changes in metabolic correlations, allowing me to resolve conflicts and generate a coherent answer.                                                     
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: The correlations among detected metabolites differed significantly between diabetic and control rats, with decreased overall correlations and specific changes, such as increased correlation between glucose  
           and urea, and disturbed correlations between glucose and lactate/TCA cycle intermediates.                                                                                                                                      
           REASONING SUMMARY: My reasoning process analyzed context chunks and Agent 2's summarization to conclude that diabetes disrupts metabolic pathways, leading to altered correlations among detected metabolites, and incorporated
           complementary insights to resolve conflicts and generate a coherent answer.                                                                                                                                                    
Agent 1 answer time: 103.19611430168152
[06:58:06] Starting paper search for 'metabolite correlations in diabetic and control rats'.                                                                                                                                              
           paper_search for query 'metabolite correlations in diabetic and control rats' and offset 0 returned 8 papers.                                                                                                                  
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:58:09] gather_evidence starting for question 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                 
[06:58:58] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
[06:59:02] Generating answer for 'How did the correlations among the detected metabolites differ between the diabetic and control rats?'.                                                                                                 
[06:59:25] Status: Paper Count=8 | Relevant Papers=2 | Current Evidence=7 | Current Cost=$0.0000                                                                                                                                          
           Answer: The correlations among detected metabolites differed significantly between diabetic and control rats. In control rats, most metabolites correlated with each other with high correlation coefficients, indicating a    
           well-controlled glucose homeostasis. In contrast, diabetic rats showed decreased correlations among many metabolites, with some correlations becoming negative. Specifically, the correlation of glucose with urea increased   
           dramatically in diabetic rats, while its correlation with lactate and TCA cycle intermediates was disturbed. Additionally, the correlations among TCA intermediates were altered, such as succinate no longer correlating with 
           2-oxoglutarate and citrate.                                                                                                                                                                                                    
                                                                                                                                                                                                                                          
           My reasoning process analyzed the context chunks (No2024 chunk 1, No2024 chunk 3, No2024 chunk 4, No2024 chunk 5, No2024 chunk 6) and Agent 1's summarization to conclude that diabetes disrupts metabolic pathways, leading to
           altered correlations among detected metabolites. I incorporated complementary insights from the context chunks, such as the changes in correlation patterns between glucose, lactate, and TCA cycle intermediates, to generate 
           a coherent answer. The context chunks provided detailed information on the differences in correlation patterns between diabetic and control rats, which helped resolve conflicts and generate an accurate answer.              
                                                                                                                                                                                                                                          
           ANSWER SUMMARY: Correlations among detected metabolites differed significantly between diabetic and control rats, with decreased overall correlations and specific changes in glucose, lactate, and TCA cycle intermediate     
           correlations.                                                                                                                                                                                                                  
           REASONING SUMMARY: Analyzed context chunks and Agent 1's summarization to conclude that diabetes disrupts metabolic pathways, incorporating complementary insights to resolve conflicts and generate a coherent answer.        
Agent 2 answer time: 82.59583640098572
Round successful.
All rounds successful.
Failed to extract final answer from multiagent consensus.


 ANSWERING QUESTION: sciqag_question_100.json
 ----------------------------- 



--- ROUND 1/2 ---
[06:59:38] Starting paper search for 'aniline derivatives detection study'.                                                                                                                                                               
           paper_search for query 'aniline derivatives detection study' and offset 0 returned 8 papers.                                                                                                                                   
           Status: Paper Count=8 | Relevant Papers=0 | Current Evidence=0 | Current Cost=$0.0000                                                                                                                                          
got papers
[06:59:40] gather_evidence starting for question 'How were the derivatives of aniline detected in this study?'.                                                                                                                           

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:03:10] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:03:12] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:03:33] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:03:35] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:03:55] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:03:58] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:04:18] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:04:20] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:04:40] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:04:43] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:05:03] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:05:05] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:05:25] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:05:28] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:05:48] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:05:50] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:06:10] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:06:13] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:06:33] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:06:35] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:06:55] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:06:57] Answer:                                                                                                                                                                                                                        

[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.


[1;31mGive Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new[0m
LiteLLM.Info: If you need to debug this error, use `litellm.set_verbose=True'.

[07:07:18] Trajectory failed.                                                                                                                                                                                                             
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1109 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1106 │   │   │   async with ceil_timeout(                                                                                                                                                                                 │
           │   1107 │   │   │   │   timeout.sock_connect, ceil_threshold=timeout.ceil_threshold                                                                                                                                          │
           │   1108 │   │   │   ):                                                                                                                                                                                                       │
           │ ❱ 1109 │   │   │   │   sock = await aiohappyeyeballs.start_connection(                                                                                                                                                      │
           │   1110 │   │   │   │   │   addr_infos=addr_infos,                                                                                                                                                                           │
           │   1111 │   │   │   │   │   local_addr_infos=self._local_addr_infos,                                                                                                                                                         │
           │   1112 │   │   │   │   │   happy_eyeballs_delay=self._happy_eyeballs_delay,                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py:123 in start_connection                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   120 │   │   │   │   │   │   isinstance(exc, OSError) and exc.errno == first_errno                                                                                                                                         │
           │   121 │   │   │   │   │   │   for exc in all_exceptions                                                                                                                                                                     │
           │   122 │   │   │   │   │   ):                                                                                                                                                                                                │
           │ ❱ 123 │   │   │   │   │   │   raise OSError(first_errno, msg)                                                                                                                                                               │
           │   124 │   │   │   │   elif isinstance(first_exception, RuntimeError) and all(                                                                                                                                               │
           │   125 │   │   │   │   │   isinstance(exc, RuntimeError) for exc in all_exceptions                                                                                                                                           │
           │   126 │   │   │   │   ):                                                                                                                                                                                                    │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:477 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    474 │   │   │   │   │   response = ModelResponse(**init_response)                                                                                                                                                        │
           │    475 │   │   │   │   response = init_response                                                                                                                                                                             │
           │    476 │   │   │   elif asyncio.iscoroutine(init_response):                                                                                                                                                                 │
           │ ❱  477 │   │   │   │   response = await init_response                                                                                                                                                                       │
           │    478 │   │   │   else:                                                                                                                                                                                                    │
           │    479 │   │   │   │   response = init_response  # type: ignore                                                                                                                                                             │
           │    480                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:564 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   561 │   │   │   )                                                                                                                                                                                                         │
           │   562 │   │   │   return model_response                                                                                                                                                                                     │
           │   563 │   except Exception as e:                                                                                                                                                                                            │
           │ ❱ 564 │   │   raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                         │
           │   565                                                                                                                                                                                                                       │
           │   566                                                                                                                                                                                                                       │
           │   567 async def ollama_aembeddings(                                                                                                                                                                                         │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py:505 in ollama_acompletion                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   502 │   try:                                                                                                                                                                                                              │
           │   503 │   │   timeout = aiohttp.ClientTimeout(total=litellm.request_timeout)  # 10 minutes                                                                                                                                  │
           │   504 │   │   async with aiohttp.ClientSession(timeout=timeout) as session:                                                                                                                                                 │
           │ ❱ 505 │   │   │   resp = await session.post(url, json=data)                                                                                                                                                                 │
           │   506 │   │   │                                                                                                                                                                                                             │
           │   507 │   │   │   if resp.status != 200:                                                                                                                                                                                    │
           │   508 │   │   │   │   text = await resp.text()                                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py:696 in _request                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │    693 │   │   │   │   │                                                                                                                                                                                                    │
           │    694 │   │   │   │   │   # connection timeout                                                                                                                                                                             │
           │    695 │   │   │   │   │   try:                                                                                                                                                                                             │
           │ ❱  696 │   │   │   │   │   │   conn = await self._connector.connect(                                                                                                                                                        │
           │    697 │   │   │   │   │   │   │   req, traces=traces, timeout=real_timeout                                                                                                                                                 │
           │    698 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │    699 │   │   │   │   │   except asyncio.TimeoutError as exc:                                                                                                                                                              │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:544 in connect                                                                                                                │
           │                                                                                                                                                                                                                             │
           │    541 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    542 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    543 │   │   │   │   │   │   await trace.send_connection_create_start()                                                                                                                                                   │
           │ ❱  544 │   │   │   │   proto = await self._create_connection(req, traces, timeout)                                                                                                                                          │
           │    545 │   │   │   │   if traces:                                                                                                                                                                                           │
           │    546 │   │   │   │   │   for trace in traces:                                                                                                                                                                             │
           │    547 │   │   │   │   │   │   await trace.send_connection_create_end()                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1050 in _create_connection                                                                                                    │
           │                                                                                                                                                                                                                             │
           │   1047 │   │   if req.proxy:                                                                                                                                                                                                │
           │   1048 │   │   │   _, proto = await self._create_proxy_connection(req, traces, timeout)                                                                                                                                     │
           │   1049 │   │   else:                                                                                                                                                                                                        │
           │ ❱ 1050 │   │   │   _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                    │
           │   1051 │   │                                                                                                                                                                                                                │
           │   1052 │   │   return proto                                                                                                                                                                                                 │
           │   1053                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1394 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1391 │   │   │   return transp, proto                                                                                                                                                                                     │
           │   1392 │   │   else:                                                                                                                                                                                                        │
           │   1393 │   │   │   assert last_exc is not None                                                                                                                                                                              │
           │ ❱ 1394 │   │   │   raise last_exc                                                                                                                                                                                           │
           │   1395 │                                                                                                                                                                                                                    │
           │   1396 │   async def _create_proxy_connection(                                                                                                                                                                              │
           │   1397 │   │   self, req: ClientRequest, traces: List["Trace"], timeout: "ClientTimeout"                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1363 in _create_direct_connection                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1360 │   │   │   )                                                                                                                                                                                                        │
           │   1361 │   │   │                                                                                                                                                                                                            │
           │   1362 │   │   │   try:                                                                                                                                                                                                     │
           │ ❱ 1363 │   │   │   │   transp, proto = await self._wrap_create_connection(                                                                                                                                                  │
           │   1364 │   │   │   │   │   self._factory,                                                                                                                                                                                   │
           │   1365 │   │   │   │   │   timeout=timeout,                                                                                                                                                                                 │
           │   1366 │   │   │   │   │   ssl=sslcontext,                                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py:1124 in _wrap_create_connection                                                                                               │
           │                                                                                                                                                                                                                             │
           │   1121 │   │   except OSError as exc:                                                                                                                                                                                       │
           │   1122 │   │   │   if exc.errno is None and isinstance(exc, asyncio.TimeoutError):                                                                                                                                          │
           │   1123 │   │   │   │   raise                                                                                                                                                                                                │
           │ ❱ 1124 │   │   │   raise client_error(req.connection_key, exc) from exc                                                                                                                                                     │
           │   1125 │                                                                                                                                                                                                                    │
           │   1126 │   async def _wrap_existing_connection(                                                                                                                                                                             │
           │   1127 │   │   self,                                                                                                                                                                                                        │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)]                     
                                                                                                                                                                                                                                          
           During handling of the above exception, another exception occurred:                                                                                                                                                            
                                                                                                                                                                                                                                          
           ╭───────────────────────────────────────────────────────────────────────────────────────────── Traceback (most recent call last) ─────────────────────────────────────────────────────────────────────────────────────────────╮
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:276 in _run_with_timeout_failure                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │   273 ) -> tuple[PQASession, AgentStatus]:                                                                                                                                                                                  │
           │   274 │   try:                                                                                                                                                                                                              │
           │   275 │   │   async with asyncio.timeout(query.settings.agent.timeout):                                                                                                                                                     │
           │ ❱ 276 │   │   │   status = await rollout()                                                                                                                                                                                  │
           │   277 │   except TimeoutError:                                                                                                                                                                                              │
           │   278 │   │   logger.warning(                                                                                                                                                                                               │
           │   279 │   │   │   f"Agent timeout after {query.settings.agent.timeout}-sec, just answering."                                                                                                                                │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:410 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   407 │   │   │   │   )                                                                                                                                                                                                     │
           │   408 │   │   │   │   return AgentStatus.TRUNCATED                                                                                                                                                                          │
           │   409 │   │   │   agent_state.messages += obs                                                                                                                                                                               │
           │ ❱ 410 │   │   │   for attempt in Retrying(                                                                                                                                                                                  │
           │   411 │   │   │   │   stop=stop_after_attempt(5),                                                                                                                                                                           │
           │   412 │   │   │   │   retry=retry_if_exception_type(MalformedMessageError),                                                                                                                                                 │
           │   413 │   │   │   │   before_sleep=before_sleep_log(logger, logging.WARNING),                                                                                                                                               │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:443 in __iter__                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   440 │   │                                                                                                                                                                                                                 │
           │   441 │   │   retry_state = RetryCallState(self, fn=None, args=(), kwargs={})                                                                                                                                               │
           │   442 │   │   while True:                                                                                                                                                                                                   │
           │ ❱ 443 │   │   │   do = self.iter(retry_state=retry_state)                                                                                                                                                                   │
           │   444 │   │   │   if isinstance(do, DoAttempt):                                                                                                                                                                             │
           │   445 │   │   │   │   yield AttemptManager(retry_state=retry_state)                                                                                                                                                         │
           │   446 │   │   │   elif isinstance(do, DoSleep):                                                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:376 in iter                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │   373 │   │   self._begin_iter(retry_state)                                                                                                                                                                                 │
           │   374 │   │   result = None                                                                                                                                                                                                 │
           │   375 │   │   for action in self.iter_state.actions:                                                                                                                                                                        │
           │ ❱ 376 │   │   │   result = action(retry_state)                                                                                                                                                                              │
           │   377 │   │   return result                                                                                                                                                                                                 │
           │   378 │                                                                                                                                                                                                                     │
           │   379 │   def _begin_iter(self, retry_state: "RetryCallState") -> None:  # noqa                                                                                                                                             │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/tenacity/__init__.py:398 in <lambda>                                                                                                               │
           │                                                                                                                                                                                                                             │
           │   395 │                                                                                                                                                                                                                     │
           │   396 │   def _post_retry_check_actions(self, retry_state: "RetryCallState") -> None:                                                                                                                                       │
           │   397 │   │   if not (self.iter_state.is_explicit_retry or self.iter_state.retry_run_result):                                                                                                                               │
           │ ❱ 398 │   │   │   self._add_action_func(lambda rs: rs.outcome.result())                                                                                                                                                     │
           │   399 │   │   │   return                                                                                                                                                                                                    │
           │   400 │   │                                                                                                                                                                                                                 │
           │   401 │   │   if self.after is not None:                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:449 in result                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │   446 │   │   │   │   if self._state in [CANCELLED, CANCELLED_AND_NOTIFIED]:                                                                                                                                                │
           │   447 │   │   │   │   │   raise CancelledError()                                                                                                                                                                            │
           │   448 │   │   │   │   elif self._state == FINISHED:                                                                                                                                                                         │
           │ ❱ 449 │   │   │   │   │   return self.__get_result()                                                                                                                                                                        │
           │   450 │   │   │   │                                                                                                                                                                                                         │
           │   451 │   │   │   │   self._condition.wait(timeout)                                                                                                                                                                         │
           │   452                                                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/concurrent/futures/_base.py:401 in __get_result                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │   398 │   def __get_result(self):                                                                                                                                                                                           │
           │   399 │   │   if self._exception:                                                                                                                                                                                           │
           │   400 │   │   │   try:                                                                                                                                                                                                      │
           │ ❱ 401 │   │   │   │   raise self._exception                                                                                                                                                                                 │
           │   402 │   │   │   finally:                                                                                                                                                                                                  │
           │   403 │   │   │   │   # Break a reference cycle with the exception in self._exception                                                                                                                                       │
           │   404 │   │   │   │   self = None                                                                                                                                                                                           │
           │                                                                                                                                                                                                                             │
           │ /storage/ice1/6/7/lpimentel3/cRAG/paper-qa/paperqa/agents/main.py:417 in rollout                                                                                                                                            │
           │                                                                                                                                                                                                                             │
           │   414 │   │   │   │   reraise=True,                                                                                                                                                                                         │
           │   415 │   │   │   ):                                                                                                                                                                                                        │
           │   416 │   │   │   │   with attempt:  # Retrying if ToolSelector fails to select a tool                                                                                                                                      │
           │ ❱ 417 │   │   │   │   │   action = await agent(agent_state.messages, tools)                                                                                                                                                 │
           │   418 │   │   │   agent_state.messages = [*agent_state.messages, action]                                                                                                                                                    │
           │   419 │   │   │   if on_agent_action_callback:                                                                                                                                                                              │
           │   420 │   │   │   │   await on_agent_action_callback(action, agent_state)                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aviary/tools/utils.py:182 in __call__                                                                                                              │
           │                                                                                                                                                                                                                             │
           │   179 │   │   │   self._ledger.messages.extend(messages)                                                                                                                                                                    │
           │   180 │   │   │   messages = self._ledger.messages                                                                                                                                                                          │
           │   181 │   │                                                                                                                                                                                                                 │
           │ ❱ 182 │   │   model_response = await self._bound_acompletion(                                                                                                                                                               │
           │   183 │   │   │   messages=MessagesAdapter.dump_python(                                                                                                                                                                     │
           │   184 │   │   │   │   messages, exclude_none=True, by_alias=True                                                                                                                                                            │
           │   185 │   │   │   ),                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:819 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    816 │   │   │   │   │   original_exception=e,                                                                                                                                                                            │
           │    817 │   │   │   │   )                                                                                                                                                                                                    │
           │    818 │   │   │   )                                                                                                                                                                                                        │
           │ ❱  819 │   │   │   raise e                                                                                                                                                                                                  │
           │    820 │                                                                                                                                                                                                                    │
           │    821 │   async def _acompletion(                                                                                                                                                                                          │
           │    822 │   │   self, model: str, messages: List[Dict[str, str]], **kwargs                                                                                                                                                   │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:795 in acompletion                                                                                                               │
           │                                                                                                                                                                                                                             │
           │    792 │   │   │   if request_priority is not None and isinstance(request_priority, int):                                                                                                                                   │
           │    793 │   │   │   │   response = await self.schedule_acompletion(**kwargs)                                                                                                                                                 │
           │    794 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱  795 │   │   │   │   response = await self.async_function_with_fallbacks(**kwargs)                                                                                                                                        │
           │    796 │   │   │   end_time = time.time()                                                                                                                                                                                   │
           │    797 │   │   │   _duration = end_time - start_time                                                                                                                                                                        │
           │    798 │   │   │   asyncio.create_task(                                                                                                                                                                                     │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2792 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2789 │   │   │   │   │   │   )                                                                                                                                                                                            │
           │   2790 │   │   │   │   │   )                                                                                                                                                                                                │
           │   2791 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2792 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2793 │                                                                                                                                                                                                                    │
           │   2794 │   def _handle_mock_testing_fallbacks(                                                                                                                                                                              │
           │   2795 │   │   self,                                                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2628 in async_function_with_fallbacks                                                                                            │
           │                                                                                                                                                                                                                             │
           │   2625 │   │   │   │   content_policy_fallbacks=content_policy_fallbacks,                                                                                                                                                   │
           │   2626 │   │   │   )                                                                                                                                                                                                        │
           │   2627 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2628 │   │   │   response = await self.async_function_with_retries(*args, **kwargs)                                                                                                                                       │
           │   2629 │   │   │   verbose_router_logger.debug(f"Async Response: {response}")                                                                                                                                               │
           │   2630 │   │   │   return response                                                                                                                                                                                          │
           │   2631 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2964 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2961 │   │   │   │   setattr(original_exception, "max_retries", num_retries)                                                                                                                                              │
           │   2962 │   │   │   │   setattr(original_exception, "num_retries", current_attempt)                                                                                                                                          │
           │   2963 │   │   │                                                                                                                                                                                                            │
           │ ❱ 2964 │   │   │   raise original_exception                                                                                                                                                                                 │
           │   2965 │                                                                                                                                                                                                                    │
           │   2966 │   async def make_call(self, original_function: Any, *args, **kwargs):                                                                                                                                              │
           │   2967 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2876 in async_function_with_retries                                                                                              │
           │                                                                                                                                                                                                                             │
           │   2873 │   │   │   │   model_group=model_group, kwargs=kwargs                                                                                                                                                               │
           │   2874 │   │   │   )                                                                                                                                                                                                        │
           │   2875 │   │   │   # if the function call is successful, no exception will be raised and we'll                                                                                                                              │
           │        break out of the loop                                                                                                                                                                                                │
           │ ❱ 2876 │   │   │   response = await self.make_call(original_function, *args, **kwargs)                                                                                                                                      │
           │   2877 │   │   │                                                                                                                                                                                                            │
           │   2878 │   │   │   return response                                                                                                                                                                                          │
           │   2879 │   │   except Exception as e:                                                                                                                                                                                       │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:2973 in make_call                                                                                                                │
           │                                                                                                                                                                                                                             │
           │   2970 │   │   model_group = kwargs.get("model")                                                                                                                                                                            │
           │   2971 │   │   response = original_function(*args, **kwargs)                                                                                                                                                                │
           │   2972 │   │   if inspect.iscoroutinefunction(response) or inspect.isawaitable(response):                                                                                                                                   │
           │ ❱ 2973 │   │   │   response = await response                                                                                                                                                                                │
           │   2974 │   │   ## PROCESS RESPONSE HEADERS                                                                                                                                                                                  │
           │   2975 │   │   await self.set_response_headers(response=response, model_group=model_group)                                                                                                                                  │
           │   2976                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:949 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    946 │   │   │   )                                                                                                                                                                                                        │
           │    947 │   │   │   if model_name is not None:                                                                                                                                                                               │
           │    948 │   │   │   │   self.fail_calls[model_name] += 1                                                                                                                                                                     │
           │ ❱  949 │   │   │   raise e                                                                                                                                                                                                  │
           │    950 │                                                                                                                                                                                                                    │
           │    951 │   def _update_kwargs_with_default_litellm_params(self, kwargs: dict) -> None:                                                                                                                                      │
           │    952 │   │   """                                                                                                                                                                                                          │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/router.py:917 in _acompletion                                                                                                              │
           │                                                                                                                                                                                                                             │
           │    914 │   │   │   │   │   parent_otel_span=parent_otel_span,                                                                                                                                                               │
           │    915 │   │   │   │   )                                                                                                                                                                                                    │
           │    916 │   │   │   │                                                                                                                                                                                                        │
           │ ❱  917 │   │   │   │   response = await _response                                                                                                                                                                           │
           │    918 │   │   │                                                                                                                                                                                                            │
           │    919 │   │   │   ## CHECK CONTENT FILTER ERROR ##                                                                                                                                                                         │
           │    920 │   │   │   if isinstance(response, ModelResponse):                                                                                                                                                                  │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1174 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1171 │   │   │   │   │   else:                                                                                                                                                                                            │
           │   1172 │   │   │   │   │   │   kwargs["model"] = context_window_fallback_dict[model]                                                                                                                                        │
           │   1173 │   │   │   │   │   return await original_function(*args, **kwargs)                                                                                                                                                  │
           │ ❱ 1174 │   │   │   raise e                                                                                                                                                                                                  │
           │   1175 │                                                                                                                                                                                                                    │
           │   1176 │   is_coroutine = inspect.iscoroutinefunction(original_function)                                                                                                                                                    │
           │   1177                                                                                                                                                                                                                      │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/utils.py:1030 in wrapper_async                                                                                                             │
           │                                                                                                                                                                                                                             │
           │   1027 │   │   │   │   return _caching_handler_response.final_embedding_cached_response                                                                                                                                     │
           │   1028 │   │   │                                                                                                                                                                                                            │
           │   1029 │   │   │   # MODEL CALL                                                                                                                                                                                             │
           │ ❱ 1030 │   │   │   result = await original_function(*args, **kwargs)                                                                                                                                                        │
           │   1031 │   │   │   end_time = datetime.datetime.now()                                                                                                                                                                       │
           │   1032 │   │   │   if "stream" in kwargs and kwargs["stream"] is True:                                                                                                                                                      │
           │   1033 │   │   │   │   if (                                                                                                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py:499 in acompletion                                                                                                                 │
           │                                                                                                                                                                                                                             │
           │    496 │   │   return response                                                                                                                                                                                              │
           │    497 │   except Exception as e:                                                                                                                                                                                           │
           │    498 │   │   custom_llm_provider = custom_llm_provider or "openai"                                                                                                                                                        │
           │ ❱  499 │   │   raise exception_type(                                                                                                                                                                                        │
           │    500 │   │   │   model=model,                                                                                                                                                                                             │
           │    501 │   │   │   custom_llm_provider=custom_llm_provider,                                                                                                                                                                 │
           │    502 │   │   │   original_exception=e,                                                                                                                                                                                    │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2122 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2119 │   │   # don't let an error with mapping interrupt the user from receiving an error                                                                                                                                 │
           │        from the llm api calls                                                                                                                                                                                               │
           │   2120 │   │   if exception_mapping_worked:                                                                                                                                                                                 │
           │   2121 │   │   │   setattr(e, "litellm_response_headers", litellm_response_headers)                                                                                                                                         │
           │ ❱ 2122 │   │   │   raise e                                                                                                                                                                                                  │
           │   2123 │   │   else:                                                                                                                                                                                                        │
           │   2124 │   │   │   for error_type in litellm.LITELLM_EXCEPTION_TYPES:                                                                                                                                                       │
           │   2125 │   │   │   │   if isinstance(e, error_type):                                                                                                                                                                        │
           │                                                                                                                                                                                                                             │
           │ /home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/litellm_core_utils/exception_mapping_utils.py:2098 in exception_type                                                                       │
           │                                                                                                                                                                                                                             │
           │   2095 │   │   │   │   │   request=original_exception.request,                                                                                                                                                              │
           │   2096 │   │   │   │   )                                                                                                                                                                                                    │
           │   2097 │   │   │   else:                                                                                                                                                                                                    │
           │ ❱ 2098 │   │   │   │   raise APIConnectionError(                                                                                                                                                                            │
           │   2099 │   │   │   │   │   message="{}\n{}".format(                                                                                                                                                                         │
           │   2100 │   │   │   │   │   │   str(original_exception), traceback.format_exc()                                                                                                                                              │
           │   2101 │   │   │   │   │   ),                                                                                                                                                                                               │
           ╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
           APIConnectionError: litellm.APIConnectionError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1109, in _wrap_create_connection                                                                                  
               sock = await aiohappyeyeballs.start_connection(                                                                                                                                                                            
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                            
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohappyeyeballs/impl.py", line 123, in start_connection                                                                                      
               raise OSError(first_errno, msg)                                                                                                                                                                                            
           ConnectionRefusedError: [Errno 111] Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1', 11434)                                                            
                                                                                                                                                                                                                                          
           The above exception was the direct cause of the following exception:                                                                                                                                                           
                                                                                                                                                                                                                                          
           Traceback (most recent call last):                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/main.py", line 477, in acompletion                                                                                                    
               response = await init_response                                                                                                                                                                                             
                          ^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 564, in ollama_acompletion                                                                                      
               raise e  # don't use verbose_logger.exception, if exception is raised                                                                                                                                                      
               ^^^^^^^                                                                                                                                                                                                                    
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/litellm/llms/ollama.py", line 505, in ollama_acompletion                                                                                      
               resp = await session.post(url, json=data)                                                                                                                                                                                  
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                  
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/client.py", line 696, in _request                                                                                                     
               conn = await self._connector.connect(                                                                                                                                                                                      
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 544, in connect                                                                                                   
               proto = await self._create_connection(req, traces, timeout)                                                                                                                                                                
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1050, in _create_connection                                                                                       
               _, proto = await self._create_direct_connection(req, traces, timeout)                                                                                                                                                      
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                      
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1394, in _create_direct_connection                                                                                
               raise last_exc                                                                                                                                                                                                             
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1363, in _create_direct_connection                                                                                
               transp, proto = await self._wrap_create_connection(                                                                                                                                                                        
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^                                                                                                                                                                        
             File "/home/hice1/lpimentel3/miniconda3/envs/cRAG/lib/python3.11/site-packages/aiohttp/connector.py", line 1124, in _wrap_create_connection                                                                                  
               raise client_error(req.connection_key, exc) from exc                                                                                                                                                                       
           aiohttp.client_exceptions.ClientConnectorError: Cannot connect to host localhost:11434 ssl:default [Multiple exceptions: [Errno 111] Connect call failed ('::1', 11434, 0, 0), [Errno 111] Connect call failed ('127.0.0.1',   
           11434)]                                                                                                                                                                                                                        
                                                                                                                                                                                                                                          
           Received Model Group=ollama/llama3.3                                                                                                                                                                                           
           Available Model Group Fallbacks=None LiteLLM Retried: 2 times, LiteLLM Max Retries: 3                                                                                                                                          
[07:07:20] Answer:                                                                                                                                                                                                                        
